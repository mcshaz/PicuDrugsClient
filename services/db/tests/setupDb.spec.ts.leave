import { fileFetch } from './../../../test-resources/FileFetch';
import { expect } from 'chai';
import { DrugsDBLocal } from '../src/injectableImplementations/DrugsLocalDb';
import { EmptyLogger } from '../src/injectableImplementations/EmptyLogger';
import { IEntityWard } from '../src/entities/IEntityWard';
import fakedb from 'fake-indexeddb';
import dbKeyRange from 'fake-indexeddb/lib/FDBKeyRange'

describe('setup local db', () => {
    const db = new DrugsDBLocal(fileFetch, new EmptyLogger(), fakedb, dbKeyRange);
    let wards: IEntityWard[];
    before(async () => {
        wards = await db.wards.toArray();
    });
    describe('data added', () => {
        it('has wards added', () => {
            expect(wards).length.is.greaterThan(0);
        });
    });
    after(async () => {
        for (const r of [db.wards, db.bolusDrugs, db.defibModels, db.fixedDrugs, db.appData]) {
            await r.clear();
        }
    });
});
